To maximize efficiency and flexibility, the following messaging model is proposed with two distinct data streams.

## Primary Stream subject: Grouped by Device

This is the main, high-throughput stream published by the DAQ nodes. It prioritizes network efficiency by grouping data from all channels on a single device into one message.

- **Subject:** `measurements.preprocessed.site.node.device.<device_id>.map.<map_version>`

- **Purpose:** Efficiently transport large volumes of time-correlated data to heavy-duty consumers like the database ingestor for e.g.

- **`preprocessed`** token: Indicates the data is not necessarily raw and may have undergone pre-processing (aggregation, filtering) at the source.

- **`device_id`**: The primary routing key for this stream, identifying the source device.

- **`map_version`**: This embeds the schema version of the payload. A consumer can now subscribe to `...device.DEV007.map.*` and be aware when the map version changes, or subscribe to `...device.DEV007.map.device_map_v3` to get only data matching a specific, known map.

Example:
`measurements.preprocessed.TS7.node01.device.DEV007.map.device_map_v3`


## Secondary Stream: Per-Channel

This stream is generated by a central Demultiplexer Service. This service subscribes to the primary grouped stream, breaks each message apart, and republishes the data for each channel individually.

- **Subject:** 
`measurements.ch.<channel_id>.<metric>.<window_ms>`

Example:
`measurements.ch.a1b2c3d4-e5f6-4a5b-8c9d-0123456789ab.RMS_500MS`

- **Purpose:** Provide a simple, granular subscription endpoint for lightweight consumers like a single UI chart or an alert that only cares about one specific metric from one channel.